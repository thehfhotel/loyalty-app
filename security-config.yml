# Security Configuration for Cloudflare Tunnel Deployment

# Environment Variables for Production
SECURITY_CONFIG:
  # JWT Configuration
  JWT_SECRET: "your-super-secure-jwt-secret-key-here"
  JWT_REFRESH_SECRET: "your-super-secure-refresh-secret-key-here"
  JWT_EXPIRY: "24h"
  REFRESH_TOKEN_EXPIRY: "30d"
  
  # Database Security
  DATABASE_URL: "postgresql://loyalty_user:secure_password@localhost:5432/loyalty_db"
  DATABASE_SSL: "prefer"
  
  # API Security
  API_RATE_LIMIT: "100"
  API_RATE_WINDOW: "15m"
  
  # CORS Configuration
  CORS_ORIGIN: "https://saichon.com"
  CORS_METHODS: "GET,POST,PUT,DELETE,OPTIONS"
  CORS_HEADERS: "Content-Type,Authorization"
  
  # Session Security
  SESSION_SECRET: "your-session-secret-key-here"
  SESSION_COOKIE_SECURE: "true"
  SESSION_COOKIE_HTTPONLY: "true"
  SESSION_COOKIE_SAMESITE: "strict"
  
  # External Services
  FIREBASE_PROJECT_ID: "your-firebase-project-id"
  FIREBASE_PRIVATE_KEY: "your-firebase-private-key"
  SENDGRID_API_KEY: "your-sendgrid-api-key"
  
  # PMS Integration
  PMS_API_URL: "https://your-pms-api.com"
  PMS_API_KEY: "your-pms-api-key"
  PMS_WEBHOOK_SECRET: "your-webhook-secret"

# Cloudflare Security Headers
CLOUDFLARE_SECURITY_HEADERS:
  X-Content-Type-Options: "nosniff"
  X-Frame-Options: "DENY"
  X-XSS-Protection: "1; mode=block"
  Strict-Transport-Security: "max-age=31536000; includeSubDomains"
  Content-Security-Policy: "default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'"
  Referrer-Policy: "strict-origin-when-cross-origin"

# Firewall Rules (to be configured in Cloudflare Dashboard)
FIREWALL_RULES:
  - name: "Block admin paths from public"
    expression: "(http.request.uri.path contains \"/admin\" and not ip.src in {your.server.ip})"
    action: "block"
    
  - name: "Rate limit API endpoints"
    expression: "(http.request.uri.path contains \"/api/\")"
    action: "challenge"
    rate_limit: "100/minute"
    
  - name: "Allow only specific countries"
    expression: "(not ip.geoip.country in {\"US\" \"CA\" \"GB\" \"DE\" \"FR\"})"
    action: "challenge"

# SSL/TLS Configuration
SSL_CONFIG:
  mode: "Full (strict)"
  min_tls_version: "1.2"
  tls_1_3: "enabled"
  automatic_https_rewrites: "enabled"
  always_use_https: "enabled"